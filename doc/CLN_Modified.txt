Connected Linear Network Process 
Input for the Connected Linear Network (CLN) Process is read from the file that is type "CLN" in the Name File.


FOR EACH SIMULATION

1. NCLN ICLNNDS ICLNCB ICLNHD ICLNDD ICLNIB NCLNGWC NCONDUITYP
These variables are free format if the option “FREE” is specified in the Basic Package input file; otherwise, the variables all have 10-character fields.

If NCLN is greater than zero, then read item 2.
2. NNDCLN(NCLN) – U1DREL

If NCLN is greater than zero and ICLNNDS is greater than zero, then read item 3. Item 3 is read NCLN times, once for each CLN segment in the simulation. The number of entries for each line of item 3 is the number of CLN cells (NNDCLN) associated with each CLN segment, as input in item 2 above. 
3. CLNCON[NNDCLN(NCLN)] 
The variables of item 3 are free format if the option “FREE” is specified in the Basic Package input file; otherwise, the variables all have 10-character fields. 

If NCLN is equal to zero, then read items 4, 5 and 6.
4. NJA_CLN

5. IAC_CLN(NODES) -  U1DINT

6. JA_CLN(NJAG)     - U1DINT

7. IFNO IFTYP IFDIR FLENG FELEV FANGLE IFLIN ICCWADI
Item 7 is read for each CLN node in the domain. Therefore, item 4 is repeated NCLNNDS times for each of the NCLNNDS Connected Linear Network nodes.

If UNSTRUCTURED option is used then read item 8. 
8. IFNOD IGWNOD IFCON FSKIN FLENGW FANISO  ICGWADI
Item 8 is read for each CLN node to porous medium grid-block connection in the domain. Therefore, item 8 is repeated NCLNGWC times for each of the NCLNGWC connections.  

Otherwise, if UNSTRUCTURED option is not used then read item 9 for structured input
9. IFNOD IGWLAY IGWROW IGWFCOL IFCON FSKIN FLENGW FANISO  ICGWADI
Item 9 is read for each CLN node to porous medium grid-block connection in the domain. Therefore, item 6 is repeated NCLNGWC times for each of the NCLNGWC connections. 

10. ICONDUITYP FRAD CONDUITK  
Item 10 is read for each conduit categorized in the model. Therefore, item 10 is repeated NCONDUITYP times for each of the NCONDUITYP types of conduit-geometries in the model. 

11. IBOUND(NCLNNDS) – U1DINT

12. STRT(NCLNNDS) – U1DREL 

-------------------------------------------------------------------------


Explanation of Variables Read by the CLN Package:

NCLN—is a flag or the number of CLN segments (a segment is defined here as a collection of linearly connected CLN nodes) simulated in the model. 
        If NCLN = 0, this flag indicates that the CLN domain connectivity is input in a general IA-JA manner as is used for the GWF Process. 

        If NCLN > 0, linear CLN segments (for instance multi-aquifer wells) or simple CLN networks are simulated and NCLN is the total number of CLN segments in the domain. 

ICLNNDS—is a flag or number of CLN-nodes simulated in the model. Multiple CLN-nodes constitute a segment.  

        If ICLNNDS < 0, the CLN-nodes are ordered in a sequential manner from the first CLN node to the last CLN node. Therefore, only linear CLN segments are simulated since a CLN segment does not share any of its nodes with another CLN segment.
   
        If ICLNNDS > 0, CLN networks can be simulated and ICLNNDS is the total number of CLN-nodes simulated by the model. CLN nodes can be shared among CLN segments in the network and therefore, the CLN-nodal connectivity for the network is also required as input. 
Note that if NCLN is zero, then ICLNNDS is the total number of CLN nodes in the model (even if the sign is negative). 

ICLNCB—is a flag and a unit number.
        If ICLNCB > 0, cell-by-cell flow terms will be written to this unit number when "SAVE BUDGET" or a nonzero value for ICBCFL is specified in Output Control. The terms that are saved are storage, and flow between adjacent cells. 

        If ICLNCB = 0, cell-by-cell flow terms will not be written.

        If ICLNCB < 0, cell-by-cell flow for CLN cells will be written in the listing file when "SAVE
BUDGET" or a non-zero value for ICBCFL is specified in Output Control. 

ICLNHD—is a flag and a unit number.
        If ICLNHD > 0, head output for CLN-nodes will be written to this unit number.  

        If ICLNHD = 0, head output for CLN-nodes will not be written.

        If ICLNHD < 0, head output for CLN-nodes will be written to the same unit number (IHEDUN) as used for head output for the porous matrix nodes. 

ICLNDD—is a flag and a unit number.
        If ICLNDD > 0, drawdown output for CLN-nodes will be written to this unit number.  

        If ICLNDD = 0, drawdown output for CLN-nodes will not be written.

        If ICLNDD < 0, drawdown output for CLN-nodes will be written to the same unit number (IDDNUN) as used for drawdown output for the porous matrix nodes. 

ICLNIB—is a flag and a unit number.
        If ICLNIB > 0, IBOUND output for CLN-nodes will be written to this unit number.  

        If ICLNIB = 0, IBOUND output for CLN-nodes will not be written.

        If ICLNIB < 0, IBOUND output for CLN-nodes will be written to the same unit number (IBOUUN) as used for IBOUND output for the porous matrix nodes. 

NCLNGWC—is the number of CLN to porous-medium grid-block connections present in the model. A CLN node need not be connected to any groundwater node. Conversely, a CLN node may be connected to multiple groundwater nodes, or multiple CLN nodes may be connected to the same porous medium mode. . 

NCONDUITYP—is the number of conduit-geometry types that are present within the model.  

NNDCLN—is the number of CLN-nodes that are associated with each CLN segment. 

CLNCON—are the CLN-node numbers associated with each CLN segment.

NJA_CLN—is the total number of connections of the CLN domain. NJA_CLN is used to dimension the sparse matrix in a compressed row storage format. 

IAC_CLN—is a matrix indicating the number of connections plus 1 for each CLN node to another CLN node. Note that the IAC_CLN array is only supplied for the CLN cells; the IAC_CLN array is internally expanded to include other domains if present in a simulation.  

JA_CLN—is a list of CLN cell number (n) followed by its connecting CLN cell numbers (m) for each of the m CLN cells connected to CLN cell n. This list is sequentially provided for the first to the last CLN cell. Note that the cell and its connections are only supplied for the CLN cells and their connections to the other CLN cells using the local CLN cell numbers. Also note that the JA_CLN list input may be chopped up to have every node number and its connectivity list on a separate line for ease in readability of the file. To further ease readability of the file, the node number of the cell whose connectivity is subsequently listed, may be expressed as a negative number the sign of which is subsequently corrected by the code. 

IFNO—is the node number for the CLN node. CLN-nodes are numbered from 1 to the total number of CLN-nodes, NCLNNDS. 

IFTYP—is the type-index for the CLN node. The type-index identifies this CLN segment type from the catalogue of CLN elements in a simulation. CLN types include different cross-section shapes (currently only circular conduit geometries are included) of different sizes. 

IFDIR—is a directional index for the CLN-node orientation. 

	If IFDIR = 0, the CLN-node is oriented in the vertical direction 

        If IFDIR = 1, the CLN-node is oriented in the horizontal direction 

        If IFDIR = 2, the CLN-node is oriented at an angle to the horizontal and the angle is read in parameter FANGLE. 
Note that the parameter IFDIR is utilized only to determine a CLN-node’s fractional saturation to determine transients or dry conditions. 

FLENG—is the length of the CLN-node segment

FELEV—is the elevation of the bottom of the CLN-node. 

FANGLE—is the angle made by a CLN-node segment from the horizontal. FANGLE is ignored if the parameter IFDIR is not equal to 2.  

IFLIN—is a flag indicating if flow within the CLN network is to be treated as linear. 

        If IFLIN = 0, flow in the CLN network at this cell is treated in a nonlinear manner as per the governing equations.  

        If IFLIN = 1, the CLN-node is treated as linear and if this is an upstream location, it’s relative permeability is fixed at unity and does not diminish to zero as the CLN cell becomes dry. This is similar to the “confined flow” option in the GW domain of MODFLOW.  

ICCWADI—is a flag indicating if vertical flow correction is applied to CLN-CLN flow at this node if it is dry. 
 
        If ICCWADI = 0, flow in the CLN network at this cell is treated without vertical flow correction.  

        If ICCWADI = 1, vertical flow correction is applied for flow within the CLN network to this node if it is dry. 

IFNOD—is the node number for the CLN node that is connected to the groundwater node. 

IGWNOD—is the node number of the connecting subsurface node for unstructured grid input. 

IGWLAY—is the layer number of the connecting subsurface node, for structured input.  

IGWROW—is the row number of the connecting subsurface node, for structured input. 

IGWCOL—is the column number of the connecting subsurface node, for structured input. 

IFCON—is an index for determining the connectivity equation between CLN-node and its associated matrix node. 

        If IFCON = 0, the Thiem equation is used to provide the connection between CLN-node and matrix node as was done in the Multi-Node Well Package of MODFLOW-2005, without any skin effects. 

        If IFCON = 1, the Thiem equation is used to provide the connection between CLN-node and matrix node as was done in the Multi-Node Well Package of MODFLOW-2005, with inclusion of skin effects. 

        If IFCON = 2, the connection between CLN-node and matrix node is computed across a leakance term as done in the Conduit Flow Process Package of MODFLOW-2005, with leakance input to the model.  

        If IFCON = 3, the connection between CLN-node and matrix node is computed across a leakance term as done in the Conduit Flow Process Package of MODFLOW-2005, with skin conductivity and skin thickness input to the model and leakance computed internally as per CLN cross-sectional geometry.  

FSKIN—This parameter determines the leakance across a skin, depending on which equation is selected to represent the flow between CLN cell and matrix. 

        If IFCON=0, the value of FSKIN is ignored and the skin resistance is taken as zero. 

        If IFCON=1, the value of FSKIN is the skin factor for a CLN-matrix connection that uses the Thiem Equation with skin resistance, 

        If IFCON=2, the value of FSKIN is the leakance of the sediments (skin) between the CLN and the matrix node for a CLN-matrix connection as used in the Conduit Flow Process Package of MODFLOW-2005. 

        If IFCON=3, the value of FSKIN is the hydraulic conductivity of the sediments (skin) between the CLN node and the matrix for computing the CLN-matrix leakance as used in the Conduit Flow Process Package of MODFLOW-2005. 

FLENGW—is the length of the connection between the CLN cell and the GW cell. 

FANISO—This parameter is used in computation of leakance across a skin, depending on which equation is selected to represent the flow between CLN node and matrix. 
 
If IFCON=0 or 1, the value of FANISO is the anisotropy factor of the porous matrix block that is connected to the CLN-node, used for computations related to the Thiem Equation. The Kx/Ky value is provided here for a vertically oriented CLN cell, and Kx/Kz is provided here for a horizontally oriented CLN cell. These anisotropies may or may not be read in the BCF or LPF packages depending on the selected simulation options, and are therefore input here to accommodate anisotropic computations for flow to wells. This input therefore provides independent control of flow to wells in anisotropic media.  

If IFCON=2, the value of FANISO is not used. 

If IFCON=3, the value of FANISO is the thickness of sediments (skin) between the CLN and matrix nodes for computing the CLN-matrix leakance as used in the Conduit Flow Process Package of MODFLOW-2005.

ICGWADI—is a flag indicating if vertical flow correction is applied to CLN-GW flow at this node if either cell is dry. 

        If ICGWADI = 0, CLN-GW flow at this cell is treated without vertical flow correction.  

        If ICGWADI = 1, vertical flow correction is applied for CLN-GW flow at this node if it is dry. 

FLENGW—is the length of the CLN-node’s connection with the groundwater node. 

ICONDUITYP—is the index for the conduit type
	
FRAD—is the radius of the conduit type

CONDUITK—is the hydraulic conductivity factor for the conduit type. Note that CONDUITK times radius squared is used to compute the conductivity of the conduit, as per laminar flow equations.  
	
NCLNNDS—is the total number of CLN-nodes. This parameter is computed internally by the code. 
	 
	 

IBOUND—is the boundary array for CLN-nodes. 
        If IBOUND(IFN) < 0, CLN-cell IFN has a constant head.
        If IBOUND(IFN) = 0, CLN-cell IFN is no flow.
        If IBOUND(IFN) > 0, CLN-cell IFN is variable head. 
	
STRT—is initial (starting) head—that is, head at the beginning of the simulation. STRT must be specified for all simulations, including steady-state simulations. One value is read for every CLN cell.  


 

